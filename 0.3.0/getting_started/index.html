
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../reference/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>Getting Started - Scrat Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#gatting-started" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Scrat Docs" class="md-header__button md-logo" aria-label="Scrat Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Scrat Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Getting Started
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/javiber/scrat" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    javiber/scrat
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../reference/" class="md-tabs__link">
          
  
  Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Scrat Docs" class="md-nav__button md-logo" aria-label="Scrat Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Scrat Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/javiber/scrat" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    javiber/scrat
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation-and-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Installation and Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation and Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-pypi" class="md-nav__link">
    <span class="md-ellipsis">
      From pypi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-github" class="md-nav__link">
    <span class="md-ellipsis">
      From Github
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serializer" class="md-nav__link">
    <span class="md-ellipsis">
      Serializer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Serializer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#specifying-a-built-in-serializer" class="md-nav__link">
    <span class="md-ellipsis">
      Specifying a built-in serializer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specifying-the-return-type" class="md-nav__link">
    <span class="md-ellipsis">
      Specifying the Return Type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-serializer" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Serializer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hashing" class="md-nav__link">
    <span class="md-ellipsis">
      Hashing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hashing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#global-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Global Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nested-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Nested Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignore-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Ignore Arguments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#force-hasher" class="md-nav__link">
    <span class="md-ellipsis">
      Force Hasher
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-hasher" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Hasher
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Class Methods
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/serializer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serializers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/hasher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hashers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation-and-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Installation and Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation and Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-pypi" class="md-nav__link">
    <span class="md-ellipsis">
      From pypi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-github" class="md-nav__link">
    <span class="md-ellipsis">
      From Github
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serializer" class="md-nav__link">
    <span class="md-ellipsis">
      Serializer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Serializer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#specifying-a-built-in-serializer" class="md-nav__link">
    <span class="md-ellipsis">
      Specifying a built-in serializer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specifying-the-return-type" class="md-nav__link">
    <span class="md-ellipsis">
      Specifying the Return Type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-serializer" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Serializer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hashing" class="md-nav__link">
    <span class="md-ellipsis">
      Hashing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hashing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#global-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Global Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nested-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Nested Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignore-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Ignore Arguments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#force-hasher" class="md-nav__link">
    <span class="md-ellipsis">
      Force Hasher
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-hasher" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Hasher
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Class Methods
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="gatting-started">Gatting Started<a class="headerlink" href="#gatting-started" title="Permanent link">#</a></h1>
<h2 id="installation-and-setup">Installation and Setup<a class="headerlink" href="#installation-and-setup" title="Permanent link">#</a></h2>
<h3 id="from-pypi">From pypi<a class="headerlink" href="#from-pypi" title="Permanent link">#</a></h3>
<p>Simply run <code>pip install scrat</code></p>
<h3 id="from-github">From Github<a class="headerlink" href="#from-github" title="Permanent link">#</a></h3>
<p>To install the latest version from github run <code>pip install git+https://github.com/javiber/scrat.git@main#egg=scrat</code></p>
<h3 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link">#</a></h3>
<p>Before using scrat you need to initialize the cache first by running <code>scrat init</code>.
This will create a folder <code>.scrat</code> in the current directory which contains the <code>stash</code> folder where the results are saved and a sqlite file (<code>stash.db</code>) where we index the results.</p>
<h2 id="basic-usage">Basic Usage<a class="headerlink" href="#basic-usage" title="Permanent link">#</a></h2>
<p>The most basic use-case is to cache the results of slow functions, let's create a slow function and call it from a python script:</p>
<pre><code class="language-python"># sample.py
import time

import scrat as sc


@sc.stash()
def slow_square(a):
    time.sleep(1)
    return a**2


if __name__ == &quot;__main__&quot;:
    a = 2
    t0 = time.time()
    result = slow_square(a)
    t1 = time.time()
    print(f&quot;Function took {t1-t0:.1f}s, the square of {a} is {result}&quot;)
</code></pre>
<p>Now we call the script from the console:</p>
<pre><code class="language-bash">&gt; python sample.py
Function took 1.0s, the square of 2 is 4

&gt; python sample.py
Function took 0.0s, the square of 2 is 4

&gt; scrat stash list
name        hash                             created_at       size
slow_square 724c8df5b6e9961d194ee0e24e385d44 2023-08-08 15:29 5.0B
</code></pre>
<blockquote>
<p>Notice that the second time we called the scrip, the result is recovered from the stash saving us the 1 second execution time.</p>
</blockquote>
<p>Next, change the parameter <code>a</code> to <code>4</code> in line <code>13</code> and call the script again.</p>
<pre><code class="language-bash">&gt; python sample.py
Function took 1.0s, the square of 4 is 16

&gt; scrat stash list
name        hash                             created_at       size
slow_square 724c8df5b6e9961d194ee0e24e385d44 2023-08-08 15:29 5.0B
slow_square 589e5491ea30ed09f40e117078a302ef 2023-08-08 15:30 5.0B
</code></pre>
<blockquote>
<p>Since we changed the parameters, the function is called again and a new entry is added to the stash.</p>
</blockquote>
<p>Finally, change the function's code in line <code>9</code> to make it return the cube of <code>a</code>, <code>a**3</code> and call the script one more time:</p>
<pre><code class="language-bash">&gt; python sample.py
Function took 1.0s, the square of 4 is 64

&gt; scrat stash list
name        hash                             created_at       size
slow_square 724c8df5b6e9961d194ee0e24e385d44 2023-08-08 15:29 5.0B
slow_square 589e5491ea30ed09f40e117078a302ef 2023-08-08 15:30 5.0B
slow_square e74a0c542fab2c6280e21d48a4fc916d 2023-08-08 15:32 5.0B
</code></pre>
<blockquote>
<p>Scrat notices that the function code has changed so it calls it again.</p>
</blockquote>
<p>Scrat is ideal to store the results of any <strong>deterministic</strong> and <strong>expensive</strong> function such as complex calculations or queries.</p>
<h2 id="serializer">Serializer<a class="headerlink" href="#serializer" title="Permanent link">#</a></h2>
<h3 id="specifying-a-built-in-serializer">Specifying a built-in serializer<a class="headerlink" href="#specifying-a-built-in-serializer" title="Permanent link">#</a></h3>
<p>By default Scrat will use pickle to store the results in disk as it can handle a wide variety of objects, however, there are better alternatives if you know the result's type.</p>
<p>For instance, you can easily switch to using json by specifying the serializer like this:</p>
<pre><code class="language-python"># json_serializer.py
import scrat as sc


@sc.stash(serializer=sc.JsonSerializer())
def get_results():
    print(&quot;function called&quot;)
    return [{&quot;result&quot;: 1}, {&quot;result&quot;: 2}]


if __name__ == &quot;__main__&quot;:
    print(get_results())
</code></pre>
<p>Now let's run the script</p>
<pre><code class="language-bash">&gt; python json_serializer.py
function called
[{'result': 1}, {'result': 2}]
&gt; python json_serializer.py
[{'result': 1}, {'result': 2}]
&gt; scrat stash list
name        hash                             created_at       size
get_results cdd21f31ae5589a465175765f0fb545d 2023-08-14 23:16 30.0B
&gt; cat .scrat/stash/get_results_cdd21f31ae5589a465175765f0fb545d
[{&quot;result&quot;: 1}, {&quot;result&quot;: 2}]
</code></pre>
<p>You can find the list of built-in serializers <a href="../reference/serializer/">here</a></p>
<h3 id="specifying-the-return-type">Specifying the Return Type<a class="headerlink" href="#specifying-the-return-type" title="Permanent link">#</a></h3>
<p>Scrat will also choose a better serializer if you indicate the return type of your function, For instance:</p>
<pre><code class="language-python"># numpy_serializer.py
import numpy as np
import scrat as sc

@sc.stash()
def np_func(size) -&gt; np.ndarray:
    print(&quot;function called&quot;)
    return np.eye(size)

if __name__ == &quot;__main__&quot;:
    print(np_func(3))
</code></pre>
<blockquote>
<p>By adding the typehint, Scrat will automatically use the <a class="autorefs autorefs-internal" href="../reference/serializer/#scrat.serializer.NumpySerializer">NumpySerializer</a> which relies on the <code>numpy.save</code> and <code>numpy.load</code> methods.</p>
</blockquote>
<h3 id="custom-serializer">Custom Serializer<a class="headerlink" href="#custom-serializer" title="Permanent link">#</a></h3>
<p>We are working on adding more serializers (pull requests are welcome 😉), in the meantime, we made sure that adding a custom Serializer can be done by implementing a simple interface:</p>
<pre><code class="language-python"># custom_serializer.py
from pathlib import Path

import torch

import scrat as sc


class TorchSerializer(sc.Serializer):
    def load(self, path: Path) -&gt; torch.Tensor:
        return torch.load(path)

    def dump(self, obj: torch.Tensor, path: Path):
        torch.save(obj, path)


@sc.stash(serializer=TorchSerializer())
def func():
    print(&quot;Function called&quot;)
    return torch.ones((3, 3))


if __name__ == &quot;__main__&quot;:
    print(func())
</code></pre>
<pre><code class="language-bash">&gt; python custom_serializer.py
Function called
tensor([[1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.]])
&gt; python custom_serializer.py
tensor([[1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.]])
&gt; scrat stash list
name       hash                             created_at       size
func       2f7059606083e1f5a1390a16900fce3a 2023-08-14 23:31 965.0B
</code></pre>
<h2 id="hashing">Hashing<a class="headerlink" href="#hashing" title="Permanent link">#</a></h2>
<p>Hashing is a very important concept, each time you invoke a stashed function a hash is calculated
and used to search for a stored result. By default, the hash includes the arguments and the function's code so you always get the correct behavior if your function meets this 3 conditions:</p>
<ul>
<li>deterministic (i.e. the output is not random or random seeds are fixed)</li>
<li>doesn't access global variables that could change</li>
<li>doesn't call another functions that could change</li>
</ul>
<p>The first point is self-explanatory, Scrat can't guess if the result of a random function is going to change or not but the other 2 points are worth discussing further.</p>
<h3 id="global-variables">Global Variables<a class="headerlink" href="#global-variables" title="Permanent link">#</a></h3>
<p>Here is a function that access a global variable:</p>
<pre><code class="language-python"># global_var.py
import scrat as sc

GLOBAL_VAR = 2


@sc.stash()
def sum_global(a=1):
    print(&quot;Function called&quot;)
    return a + GLOBAL_VAR


if __name__ == &quot;__main__&quot;:
    a = 1
    # The First call gets the correct result
    print(f&quot;{a}+{GLOBAL_VAR}={sum_global(1)}&quot;)

    GLOBAL_VAR = 3
    # The function and the parameters have not changed so Scrat will return the old
    # value of 3.
    # This happens because GLOBAL_VAR is not being considered in the hash
    print(f&quot;{a}+{GLOBAL_VAR}={sum_global(1)}&quot;)

</code></pre>
<p>Luckely, this is easily fixable by adding a watched global variable:</p>
<pre><code class="language-python"># global_car_fixed.py
import scrat as sc

GLOBAL_VAR = 2


@sc.stash(watch_globals=[&quot;GLOBAL_VAR&quot;])
def sum_global(a=1):
    print(&quot;Function called&quot;)
    return a + GLOBAL_VAR


if __name__ == &quot;__main__&quot;:
    a = 1
    # The First call gets the correct result
    print(f&quot;{a}+{GLOBAL_VAR}={sum_global(1)}&quot;)

    GLOBAL_VAR = 3
    # And the second one does too
    print(f&quot;{a}+{GLOBAL_VAR}={sum_global(1)}&quot;)
</code></pre>
<p>Now the behavior is corrected:</p>
<pre><code class="language-bash">&gt; python global_var_fixed.py
Function called
1+2=3
Function called
1+3=4
</code></pre>
<h3 id="nested-functions">Nested Functions<a class="headerlink" href="#nested-functions" title="Permanent link">#</a></h3>
<p>Similarly if your function calls another function which code changed, Scrat is not going to notice and it will return the old result but, again, this is easily fixable by adding a watched function:</p>
<pre><code class="language-python"># nested_function.py
import scrat as sc


def nested_func():
    return 2


@sc.stash(watch_functions=[nested_func])
def func(a=1):
    print(&quot;Function called&quot;)
    return a + nested_func()


if __name__ == &quot;__main__&quot;:
    print(func(1))
</code></pre>
<blockquote>
<p>Now if you ever change the result of nested_func, the function is going to be re-run.</p>
</blockquote>
<h3 id="ignore-arguments">Ignore Arguments<a class="headerlink" href="#ignore-arguments" title="Permanent link">#</a></h3>
<p>By default, Scrat assumes that all the arguments affect the result which might not allways be true.
For instance some arguments might only affect the logging and thus should not be included in the hash this can be controlled using the <code>ignore_args</code>:</p>
<pre><code class="language-python"># ignore_argmuents.py
import scrat as sc

@sc.stash(ignore_args=[&quot;verbose&quot;])
def double(a, verbose):
    if verbose:
        print(f&quot;Function called with verbose={verbose}&quot;)
    else:
        print(&quot;Function called&quot;)
    return a * 2


if __name__ == &quot;__main__&quot;:
    print(double(1, verbose=True))
    print(double(1, verbose=False))
</code></pre>
<h3 id="force-hasher">Force Hasher<a class="headerlink" href="#force-hasher" title="Permanent link">#</a></h3>
<p>Scrat tries to use a sane hasher according to the type of each argument, unfurtunatelly, this can fail. We are working on making this process more robust but in the meantime, if you encounter any issue you can control which hasher is used
for each argument:</p>
<pre><code class="language-python"># force_hasher.py
import numpy as np

import scrat as sc


@sc.stash(hashers={&quot;a&quot;: sc.NumpyHasher()})
def double(a):
    return a * 2


if __name__ == &quot;__main__&quot;:
    print(double(np.arange(10)))
</code></pre>
<p>This is useful if you want to change the default parameters of some of the hashers, for more info about the available hashers, check this <a class="autorefs autorefs-internal" href="../reference/hasher/#scrat.hasher">doc</a>.</p>
<h3 id="custom-hasher">Custom Hasher<a class="headerlink" href="#custom-hasher" title="Permanent link">#</a></h3>
<p>Adding a custom hasher is easy, you just need to implement a simple interface and tell scrat which parameters should use it:</p>
<pre><code class="language-python"># custom_hasher.py
import torch

import scrat as sc


class TorchHasher(sc.hasher.Hasher):
    def hash(self, value: torch.Tensor) -&gt; str:
        return self.md5_hash(value.numpy())


@sc.stash(hashers={&quot;a&quot;: TorchHasher()})
def double(a):
    return a * 2


if __name__ == &quot;__main__&quot;:
    print(double(torch.arange(10)))
</code></pre>
<p>The class <a class="autorefs autorefs-internal" href="../reference/hasher/#scrat.hasher.Hasher">Hasher</a> provides the method <a class="autorefs autorefs-internal" href="../reference/hasher/#scrat.hasher.Hasher.md5_hash">md5_hash</a> that turns any string of buffer into an md5 digest, we encourage you to use it in your custom Hashers.</p>
<h3 id="class-methods">Class Methods<a class="headerlink" href="#class-methods" title="Permanent link">#</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently scrat can't does not include any binded argument (such as <code>self</code>) to the hash. We plan to add this feature shortly.</p>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.sections", "navigation.tabs"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>